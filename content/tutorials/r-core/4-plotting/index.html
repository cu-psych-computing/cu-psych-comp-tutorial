---
title: "Plotting with `ggplot2`"
subtitle: "CU Psych Scientific Computing Workshop"
tags: ["core", "R"]
weight: 400
---

<script src="/rmarkdown-libs/accessible-code-block/empty-anchor.js"></script>
<link href="/rmarkdown-libs/anchor-sections/anchor-sections.css" rel="stylesheet" />
<script src="/rmarkdown-libs/anchor-sections/anchor-sections.js"></script>
<style type="text/css">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  background-color: #f8f8f8; }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ef2929; } /* Alert */
code span.an { color: #8f5902; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #c4a000; } /* Attribute */
code span.bn { color: #0000cf; } /* BaseN */
code span.cf { color: #204a87; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4e9a06; } /* Char */
code span.cn { color: #000000; } /* Constant */
code span.co { color: #8f5902; font-style: italic; } /* Comment */
code span.cv { color: #8f5902; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #8f5902; font-weight: bold; font-style: italic; } /* Documentation */
code span.dt { color: #204a87; } /* DataType */
code span.dv { color: #0000cf; } /* DecVal */
code span.er { color: #a40000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #0000cf; } /* Float */
code span.fu { color: #000000; } /* Function */
code span.im { } /* Import */
code span.in { color: #8f5902; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #204a87; font-weight: bold; } /* Keyword */
code span.op { color: #ce5c00; font-weight: bold; } /* Operator */
code span.ot { color: #8f5902; } /* Other */
code span.pp { color: #8f5902; font-style: italic; } /* Preprocessor */
code span.sc { color: #000000; } /* SpecialChar */
code span.ss { color: #4e9a06; } /* SpecialString */
code span.st { color: #4e9a06; } /* String */
code span.va { color: #000000; } /* Variable */
code span.vs { color: #4e9a06; } /* VerbatimString */
code span.wa { color: #8f5902; font-weight: bold; font-style: italic; } /* Warning */
</style>


<div id="what-is-this-tutorial-whats-ggplot2" class="section level1">
<h1>What Is This Tutorial? What’s <code>ggplot2</code>?</h1>
<p>ggplot2 is a package in R that allows for highly customizable and pretty plots! Here, were going to learn a few basics of making plots using <code>ggplot2</code> that will hopefully get you well on your way to making informative and beautiful data visualizations!</p>
</div>
<div id="links-to-files-and-video-recording" class="section level1">
<h1>Links to Files and Video Recording</h1>
<p>The files for all tutorials can be downloaded from <a href="https://github.com/cu-psych-computing/cu-psych-comp-tutorial" target="_blank">the Columbia Psychology Scientific Computing GitHub page</a> using <a href="/accessing-files/" target="_blank">these instructions</a>. This particular file is located here: <code>/content/tutorials/r-core/4-plotting/index.rmd</code>.</p>
<p>For a video recording of this tutorial from the Fall 2020 workshop, please visit the <a href="/workshop-recording/session2/" target="_blank">Workshop Recording: Session 2</a> page.</p>
</div>
<div id="load-packages-and-data" class="section level1">
<h1>Load Packages and Data</h1>
<div id="first-load-tidyverse-which-includes-ggplot2" class="section level2">
<h2>First load <code>tidyverse</code>, which includes <code>ggplot2</code></h2>
<p>We’ve already done this in the special first chunk up top, so it should run automatically before you run any chunk of code lower in the document.</p>
</div>
<div id="load-in-sample-data" class="section level2">
<h2>Load in sample data</h2>
<p>We’re going to practice here on a dataset from the 1990 NHANES (National Health and Nutrition Examination Survey). The variables are below.</p>
<ul>
<li><p>Region – Geographic region in the USA: Northeast (1), Midwest (2), South (3), and West (4)</p></li>
<li><p>Sex – Biological sex: Male (1), Female (2)</p></li>
<li><p>Age – Age measured in months (we’ll convert this to years below)</p></li>
<li><p>Urban – Residential population density: Metropolital Area (1), Other (2)</p></li>
<li><p>Weight – Weight in pounds</p></li>
<li><p>Height – Height in inches</p></li>
<li><p>BMI – BMI, measured in kg/(m^2)</p></li>
</ul>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a>nhanes &lt;-<span class="st"> </span><span class="kw">read_csv</span>(<span class="kw">here</span>(<span class="st">&quot;content&quot;</span>, <span class="st">&quot;tutorials&quot;</span>, <span class="st">&quot;r-core&quot;</span>, <span class="st">&quot;4-plotting&quot;</span>, <span class="st">&quot;NHANES1990.csv&quot;</span>))</span></code></pre></div>
<pre><code>## Parsed with column specification:
## cols(
##   Region = col_double(),
##   Sex = col_double(),
##   Age = col_double(),
##   Urban = col_double(),
##   Weight = col_double(),
##   Height = col_double(),
##   BMI = col_double()
## )</code></pre>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1"></a>nhanes &lt;-<span class="st"> </span><span class="kw">mutate</span>(nhanes,</span>
<span id="cb3-2"><a href="#cb3-2"></a>                 <span class="dt">Age =</span> Age<span class="op">/</span><span class="dv">12</span>, <span class="co"># convert age to years</span></span>
<span id="cb3-3"><a href="#cb3-3"></a>                 <span class="dt">Urban =</span> dplyr<span class="op">::</span><span class="kw">recode</span>(Urban, <span class="st">&#39;1&#39;</span> =<span class="st"> &#39;Metro Area&#39;</span>, <span class="st">&#39;2&#39;</span> =<span class="st"> &#39;Non-Metro Area&#39;</span>),</span>
<span id="cb3-4"><a href="#cb3-4"></a>                 <span class="dt">Region =</span> dplyr<span class="op">::</span><span class="kw">recode</span>(Region, <span class="st">&#39;1&#39;</span> =<span class="st"> &#39;Northeast&#39;</span>, <span class="st">&#39;2&#39;</span> =<span class="st"> &#39;Midwest&#39;</span>, <span class="st">&#39;3&#39;</span> =<span class="st"> &#39;South&#39;</span>, <span class="st">&#39;4&#39;</span> =<span class="st"> &#39;West&#39;</span>))</span>
<span id="cb3-5"><a href="#cb3-5"></a></span>
<span id="cb3-6"><a href="#cb3-6"></a>nhanes</span></code></pre></div>
<pre><code>## # A tibble: 27,821 x 7
##    Region    Sex   Age Urban          Weight Height   BMI
##    &lt;chr&gt;   &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt;           &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt;
##  1 South       2 42.8  Non-Metro Area  172.    65.3  28.4
##  2 West        1 25.6  Non-Metro Area  155.    62.3  28.2
##  3 West        2 73.8  Metro Area      167.    59.2  33.5
##  4 West        1 38.2  Metro Area      225.    71.9  30.6
##  5 Midwest     1 74    Non-Metro Area  245     67.7  37.6
##  6 West        2  2.75 Metro Area       28.3   35.2  16  
##  7 Midwest     1  3.25 Metro Area       29.3   38.6  13.8
##  8 South       1 17.4  Non-Metro Area  188.    57.9  39.5
##  9 Midwest     1  4.08 Metro Area       36.6   41.9  14.7
## 10 West        2 48.2  Non-Metro Area  182.    61.9  33.5
## # … with 27,811 more rows</code></pre>
</div>
</div>
<div id="basic-ggplot2-syntax" class="section level1">
<h1>Basic <code>ggplot2</code> Syntax</h1>
<ul>
<li><p><code>ggplot()</code> command usage includes saving to a variable with <code>a &lt;- ggplot()</code></p></li>
<li><p>The general format is <code>ggplot(data, aes(x = [x axis variable], y = [y axis variable])</code></p>
<ul>
<li>x and y variables are always specified in this <code>aes()</code> subfunction</li>
</ul></li>
</ul>
<p>Run this line of code:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1"></a><span class="kw">ggplot</span>(nhanes, <span class="kw">aes</span>(<span class="dt">x =</span> Age, <span class="dt">y =</span> Weight))</span></code></pre></div>
<p><img src="/tutorials/r-core/4-plotting/index_files/figure-html/unnamed-chunk-2-1.png" width="672" /></p>
<ul>
<li>Axes are set up the way we’d expect, and seem to have sensible values</li>
<li>Why is nothing on this graph yet? we haven’t put any graphic actually on the axes yet</li>
</ul>
<p><strong>We need to tell the <code>ggplot()</code> call what kind of graphic to put on the axis.</strong></p>
<ul>
<li>A lot of the time, the syntax is <code>geom_[something]</code></li>
</ul>
</div>
<div id="example-plot-types" class="section level1">
<h1>Example Plot Types</h1>
<div id="scatter-plots" class="section level2">
<h2>Scatter plots</h2>
<p>Let’s create a scatter plot using <code>geom_point()</code> first. The <code>ggplot()</code> function generates plots in layers, from “bottom” to “top”, and each layer of the plot is separated by the <code>+</code> sign.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1"></a><span class="co"># Although you can keep the code all on a single line, like this:</span></span>
<span id="cb6-2"><a href="#cb6-2"></a><span class="kw">ggplot</span>(nhanes, <span class="kw">aes</span>(<span class="dt">x =</span> Age, <span class="dt">y =</span> Weight)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_point</span>()</span></code></pre></div>
<p><img src="/tutorials/r-core/4-plotting/index_files/figure-html/unnamed-chunk-3-1.png" width="672" /></p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1"></a><span class="co"># As you add more and more layers, it can be helpful to add a</span></span>
<span id="cb7-2"><a href="#cb7-2"></a><span class="co"># line break after each `+` sign, like this:</span></span>
<span id="cb7-3"><a href="#cb7-3"></a><span class="kw">ggplot</span>(nhanes, <span class="kw">aes</span>(<span class="dt">x =</span> Age, <span class="dt">y =</span> Weight)) <span class="op">+</span></span>
<span id="cb7-4"><a href="#cb7-4"></a><span class="st">  </span><span class="kw">geom_point</span>()</span></code></pre></div>
<p><img src="/tutorials/r-core/4-plotting/index_files/figure-html/unnamed-chunk-3-2.png" width="672" /></p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1"></a><span class="co"># Note that these plots are identical! The latter format simply</span></span>
<span id="cb8-2"><a href="#cb8-2"></a><span class="co"># makes it easier to read the code at a glance.</span></span></code></pre></div>
<p>Wow, lots of data points! Maybe we can make the points smaller to see better.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1"></a>ageWeightPlot &lt;-<span class="st"> </span><span class="kw">ggplot</span>(nhanes, <span class="kw">aes</span>(<span class="dt">x =</span> Age, <span class="dt">y =</span> Weight)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb9-2"><a href="#cb9-2"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">size =</span> <span class="fl">.1</span>, <span class="dt">alpha =</span> <span class="fl">.3</span>)</span>
<span id="cb9-3"><a href="#cb9-3"></a></span>
<span id="cb9-4"><a href="#cb9-4"></a>ageWeightPlot</span></code></pre></div>
<p><img src="/tutorials/r-core/4-plotting/index_files/figure-html/unnamed-chunk-4-1.png" width="672" /></p>
<p>Remember, it’s a good habit to save your plots to objects, not just draw them!</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1"></a>ageWeightPlot &lt;-<span class="st"> </span><span class="kw">ggplot</span>(nhanes, <span class="kw">aes</span>(<span class="dt">x =</span> Age, <span class="dt">y =</span> Weight)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb10-2"><a href="#cb10-2"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">size =</span> <span class="dv">1</span>, <span class="dt">alpha =</span> <span class="fl">.2</span>, <span class="kw">aes</span>(<span class="dt">color =</span> Region, <span class="dt">pch =</span> Region))</span>
<span id="cb10-3"><a href="#cb10-3"></a></span>
<span id="cb10-4"><a href="#cb10-4"></a>ageWeightPlot</span></code></pre></div>
<p><img src="/tutorials/r-core/4-plotting/index_files/figure-html/unnamed-chunk-5-1.png" width="672" /></p>
</div>
<div id="histograms" class="section level2">
<h2>Histograms</h2>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1"></a>weightHistogram &lt;-<span class="st"> </span><span class="kw">ggplot</span>(nhanes) <span class="op">+</span></span>
<span id="cb11-2"><a href="#cb11-2"></a><span class="st">  </span><span class="kw">geom_histogram</span>(<span class="kw">aes</span>(<span class="dt">x =</span> Weight), <span class="dt">bins =</span> <span class="dv">100</span>, <span class="dt">fill =</span> <span class="st">&#39;purple&#39;</span>)</span>
<span id="cb11-3"><a href="#cb11-3"></a></span>
<span id="cb11-4"><a href="#cb11-4"></a>weightHistogram</span></code></pre></div>
<p><img src="/tutorials/r-core/4-plotting/index_files/figure-html/unnamed-chunk-6-1.png" width="672" /></p>
</div>
<div id="dot-plots-organized-by-grouping-factor" class="section level2">
<h2>Dot plots organized by grouping factor</h2>
<p>Question: what if we want to look at distribution of weights by region in the nhanes data?</p>
<p>With <code>ggplot2</code>, if x is a factor (discrete, not continuous) we can plot dots as a function of the factor.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1"></a>heightByUrban &lt;-<span class="st"> </span><span class="kw">ggplot</span>(nhanes, <span class="kw">aes</span>(<span class="dt">x =</span> Urban, <span class="dt">y =</span> Height)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb12-2"><a href="#cb12-2"></a><span class="st">  </span><span class="kw">geom_point</span>()</span>
<span id="cb12-3"><a href="#cb12-3"></a></span>
<span id="cb12-4"><a href="#cb12-4"></a>heightByUrban</span></code></pre></div>
<p><img src="/tutorials/r-core/4-plotting/index_files/figure-html/unnamed-chunk-7-1.png" width="672" /></p>
<p>Whoa! So much data, it’s hard to see anything. Let’s use <code>geom_jitter()</code> with size = .05, width = .1 instead.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1"></a>heightByUrban &lt;-<span class="st"> </span><span class="kw">ggplot</span>(nhanes, <span class="kw">aes</span>(<span class="dt">x =</span> Urban, <span class="dt">y =</span> Height)) <span class="op">+</span></span>
<span id="cb13-2"><a href="#cb13-2"></a><span class="st">  </span><span class="kw">geom_jitter</span>(<span class="dt">size =</span> <span class="fl">.05</span>, <span class="dt">width =</span> <span class="fl">.1</span>, <span class="dt">height =</span> <span class="dv">0</span>, <span class="dt">alpha =</span> <span class="fl">.1</span>)</span>
<span id="cb13-3"><a href="#cb13-3"></a></span>
<span id="cb13-4"><a href="#cb13-4"></a>heightByUrban</span></code></pre></div>
<p><img src="/tutorials/r-core/4-plotting/index_files/figure-html/unnamed-chunk-8-1.png" width="672" /></p>
</div>
<div id="violin-plots-to-visualize-distributions" class="section level2">
<h2>Violin plots to visualize distributions</h2>
<p>Still a TON of data! Here’s a great tool I really like for plotting the density of distributions of points like this!</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1"></a><span class="co"># We can use &#39;source&#39; to pull bits of code from github, as well as local files</span></span>
<span id="cb14-2"><a href="#cb14-2"></a><span class="kw">source</span>(<span class="st">&quot;https://gist.githubusercontent.com/benmarwick/2a1bb0133ff568cbe28d/raw/fb53bd97121f7f9ce947837ef1a4c65a73bffb3f/geom_flat_violin.R&quot;</span>) </span>
<span id="cb14-3"><a href="#cb14-3"></a></span>
<span id="cb14-4"><a href="#cb14-4"></a>heightByUrban <span class="op">+</span></span>
<span id="cb14-5"><a href="#cb14-5"></a><span class="st">  </span><span class="kw">geom_flat_violin</span>(<span class="dt">position =</span> <span class="kw">position_nudge</span>(<span class="dt">x =</span> <span class="fl">.15</span>, <span class="dt">y =</span> <span class="dv">0</span>), <span class="dt">alpha =</span> <span class="fl">.7</span>)</span></code></pre></div>
<p><img src="/tutorials/r-core/4-plotting/index_files/figure-html/unnamed-chunk-9-1.png" width="672" /></p>
<p>Now, we can really begin to see the skewedness of these weight distributions.</p>
</div>
<div id="summary-plots" class="section level2">
<h2>Summary plots</h2>
<p>Plotting data points is all well and good, but what if we want to use our plots to summarize distributions? We’ll do that here.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1"></a>weightByRegion &lt;-<span class="st"> </span><span class="kw">ggplot</span>(nhanes, <span class="kw">aes</span>(<span class="dt">x =</span> Region, <span class="dt">y =</span> Weight)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb15-2"><a href="#cb15-2"></a><span class="st">  </span><span class="kw">stat_summary</span>(<span class="dt">fun =</span> <span class="st">&quot;mean&quot;</span>, <span class="dt">geom =</span> <span class="st">&quot;point&quot;</span>)</span>
<span id="cb15-3"><a href="#cb15-3"></a></span>
<span id="cb15-4"><a href="#cb15-4"></a>weightByRegion <span class="op">+</span></span>
<span id="cb15-5"><a href="#cb15-5"></a><span class="st">  </span><span class="kw">ylim</span>(<span class="dv">0</span>,<span class="dv">400</span>)</span></code></pre></div>
<pre><code>## Warning: Removed 7 rows containing non-finite values (stat_summary).</code></pre>
<p><img src="/tutorials/r-core/4-plotting/index_files/figure-html/unnamed-chunk-10-1.png" width="672" /></p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1"></a><span class="co"># Here is how to plot the group means with confidence intervals</span></span>
<span id="cb17-2"><a href="#cb17-2"></a>weightByRegionConf &lt;-<span class="st"> </span><span class="kw">ggplot</span>(nhanes, <span class="kw">aes</span>(<span class="dt">x =</span> Region, <span class="dt">y =</span> Weight)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb17-3"><a href="#cb17-3"></a><span class="st">  </span><span class="kw">stat_summary</span>(<span class="dt">fun.data =</span> <span class="st">&quot;mean_cl_boot&quot;</span>, <span class="dt">fun.args =</span> <span class="kw">list</span>(<span class="dt">conf.int =</span> <span class="fl">.95</span>))</span>
<span id="cb17-4"><a href="#cb17-4"></a></span>
<span id="cb17-5"><a href="#cb17-5"></a>weightByRegionConf</span></code></pre></div>
<p><img src="/tutorials/r-core/4-plotting/index_files/figure-html/unnamed-chunk-10-2.png" width="672" /></p>
<p>It might be useful to look at the summary with the raw data too…just to put any potential region differences in context.</p>
<p>Be sure to note that when we do this, <code>ggplot()</code> adds these “layers” to the plot from the bottom up!</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1"></a><span class="co"># If we just add the `geom_jitter()` call to the end of the function,</span></span>
<span id="cb18-2"><a href="#cb18-2"></a><span class="co"># the raw data is the last layer added to the plot, which obscures the means!</span></span>
<span id="cb18-3"><a href="#cb18-3"></a>rawPlusSummary &lt;-<span class="st"> </span><span class="kw">ggplot</span>(nhanes, <span class="kw">aes</span>(<span class="dt">x =</span> Region, <span class="dt">y =</span> Weight)) <span class="op">+</span></span>
<span id="cb18-4"><a href="#cb18-4"></a><span class="st">  </span><span class="kw">stat_summary</span>(<span class="dt">fun.data =</span> <span class="st">&quot;mean_cl_boot&quot;</span>, <span class="dt">fun.args =</span> <span class="kw">list</span>(<span class="dt">conf.int =</span> <span class="fl">.95</span>), <span class="dt">color =</span> <span class="st">&#39;red&#39;</span>) <span class="op">+</span></span>
<span id="cb18-5"><a href="#cb18-5"></a><span class="st">  </span><span class="kw">geom_jitter</span>(<span class="dt">size =</span> <span class="fl">.1</span>, <span class="dt">alpha =</span> <span class="fl">.1</span>, <span class="dt">height =</span> <span class="dv">0</span>, <span class="dt">width =</span> <span class="fl">.1</span>)</span>
<span id="cb18-6"><a href="#cb18-6"></a></span>
<span id="cb18-7"><a href="#cb18-7"></a>rawPlusSummary</span></code></pre></div>
<p><img src="/tutorials/r-core/4-plotting/index_files/figure-html/unnamed-chunk-11-1.png" width="672" /></p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1"></a><span class="co"># In this version, we have reversed the ordering of `geom_jitter()` and</span></span>
<span id="cb19-2"><a href="#cb19-2"></a><span class="co"># `stat_summary()` so we can easily see the raw data AND the means</span></span>
<span id="cb19-3"><a href="#cb19-3"></a>rawPlusSummary &lt;-<span class="st"> </span><span class="kw">ggplot</span>(nhanes, <span class="kw">aes</span>(<span class="dt">x =</span> Region, <span class="dt">y =</span> Weight)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb19-4"><a href="#cb19-4"></a><span class="st">  </span><span class="kw">geom_jitter</span>(<span class="dt">size =</span> <span class="fl">.1</span>, <span class="dt">alpha =</span> <span class="fl">.1</span>, <span class="dt">height =</span> <span class="dv">0</span>, <span class="dt">width =</span> <span class="fl">.1</span>) <span class="op">+</span></span>
<span id="cb19-5"><a href="#cb19-5"></a><span class="st">  </span><span class="kw">stat_summary</span>(<span class="dt">fun.data =</span> <span class="st">&quot;mean_cl_boot&quot;</span>, <span class="dt">fun.args =</span> <span class="kw">list</span>(<span class="dt">conf.int =</span> <span class="fl">.95</span>), <span class="dt">color =</span> <span class="st">&#39;red&#39;</span>)</span>
<span id="cb19-6"><a href="#cb19-6"></a></span>
<span id="cb19-7"><a href="#cb19-7"></a>rawPlusSummary</span></code></pre></div>
<p><img src="/tutorials/r-core/4-plotting/index_files/figure-html/unnamed-chunk-11-2.png" width="672" /></p>
<p>We can also add the density plots!</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1"></a>rawPlusSummary &lt;-<span class="st"> </span><span class="kw">ggplot</span>(nhanes, <span class="kw">aes</span>(<span class="dt">x =</span> Region, <span class="dt">y =</span> Weight)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb20-2"><a href="#cb20-2"></a><span class="st">  </span><span class="kw">geom_jitter</span>(<span class="dt">size =</span> <span class="fl">.1</span>, <span class="dt">alpha =</span> <span class="fl">.1</span>, <span class="dt">height =</span> <span class="dv">0</span>, <span class="dt">width =</span> <span class="fl">.1</span>) <span class="op">+</span></span>
<span id="cb20-3"><a href="#cb20-3"></a><span class="st">  </span><span class="kw">geom_flat_violin</span>(<span class="dt">position =</span> <span class="kw">position_nudge</span>(<span class="dt">x =</span> <span class="fl">.15</span>, <span class="dt">y =</span> <span class="dv">0</span>)) <span class="op">+</span></span>
<span id="cb20-4"><a href="#cb20-4"></a><span class="st">  </span><span class="kw">stat_summary</span>(<span class="dt">fun.data =</span> <span class="st">&quot;mean_cl_boot&quot;</span>, <span class="dt">fun.args =</span> <span class="kw">list</span>(<span class="dt">conf.int =</span> <span class="fl">.95</span>),</span>
<span id="cb20-5"><a href="#cb20-5"></a>               <span class="dt">color =</span> <span class="st">&#39;red&#39;</span>, <span class="dt">position =</span> <span class="kw">position_nudge</span>(<span class="dt">x =</span> <span class="fl">.2</span>, <span class="dt">y =</span> <span class="dv">0</span>))</span>
<span id="cb20-6"><a href="#cb20-6"></a></span>
<span id="cb20-7"><a href="#cb20-7"></a>rawPlusSummary</span></code></pre></div>
<p><img src="/tutorials/r-core/4-plotting/index_files/figure-html/unnamed-chunk-12-1.png" width="672" /></p>
<p>Now that we can visualize the distributions, we can see that weight is bimodally distributed (probably because of the young children in this dataset).</p>
</div>
<div id="heatmaps" class="section level2">
<h2>Heatmaps</h2>
<p>Sometimes we might want to make a heatmap to look at the value of variable based on a 2D grid of two other variables.</p>
<p>This is kind of a silly example, but say we wanted to map out the number of observations in our dataset as a factor of region and neighborhood type.</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1"></a><span class="co"># group the data</span></span>
<span id="cb21-2"><a href="#cb21-2"></a>nhanesGroup &lt;-<span class="st"> </span>nhanes <span class="op">%&gt;%</span></span>
<span id="cb21-3"><a href="#cb21-3"></a><span class="st">  </span><span class="kw">group_by</span>(Region, Urban) <span class="op">%&gt;%</span></span>
<span id="cb21-4"><a href="#cb21-4"></a><span class="st">  </span><span class="kw">summarize</span>(<span class="dt">Observations =</span> <span class="kw">n</span>())</span></code></pre></div>
<pre><code>## `summarise()` regrouping output by &#39;Region&#39; (override with `.groups` argument)</code></pre>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1"></a><span class="kw">ggplot</span>(nhanesGroup, <span class="kw">aes</span>(<span class="dt">x =</span> Urban, <span class="dt">y =</span> Region)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb23-2"><a href="#cb23-2"></a><span class="st">  </span><span class="kw">geom_tile</span>(<span class="kw">aes</span>(<span class="dt">fill =</span> Observations)) <span class="op">+</span></span>
<span id="cb23-3"><a href="#cb23-3"></a><span class="st">  </span><span class="kw">scale_fill_gradient</span>(<span class="dt">low =</span> <span class="st">&quot;blue&quot;</span>, <span class="dt">high =</span> <span class="st">&quot;red&quot;</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb23-4"><a href="#cb23-4"></a><span class="st">  </span><span class="kw">theme_bw</span>()</span></code></pre></div>
<p><img src="/tutorials/r-core/4-plotting/index_files/figure-html/unnamed-chunk-13-1.png" width="672" /></p>
</div>
<div id="time-series-plots" class="section level2">
<h2>Time series plots</h2>
<p><strong>Working with a different dataset here</strong></p>
<p>Let’s make up some very simple data on the prices of two different items from 1978-2017.</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1"></a>years &lt;-<span class="st"> </span><span class="dv">1978</span><span class="op">:</span><span class="dv">2017</span></span>
<span id="cb24-2"><a href="#cb24-2"></a>item1&lt;-<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">40</span>,<span class="dv">100</span>,<span class="dv">5</span>)</span>
<span id="cb24-3"><a href="#cb24-3"></a>item2 &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">:</span><span class="dv">40</span> <span class="op">+</span><span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">40</span>,<span class="dv">100</span>,<span class="dv">5</span>)</span>
<span id="cb24-4"><a href="#cb24-4"></a></span>
<span id="cb24-5"><a href="#cb24-5"></a><span class="co"># Helpful to put it in long form using pivot_longer</span></span>
<span id="cb24-6"><a href="#cb24-6"></a>timeFrame &lt;-<span class="st"> </span><span class="kw">tibble</span>(<span class="dt">years =</span> years, <span class="dt">item1 =</span> item1, <span class="dt">item2 =</span> item2) <span class="op">%&gt;%</span></span>
<span id="cb24-7"><a href="#cb24-7"></a><span class="st">  </span><span class="kw">pivot_longer</span>(<span class="dt">cols =</span> <span class="kw">starts_with</span>(<span class="st">&#39;item&#39;</span>), <span class="dt">names_to =</span> <span class="st">&#39;item&#39;</span>, <span class="dt">values_to =</span> <span class="st">&#39;price&#39;</span>) <span class="op">%&gt;%</span></span>
<span id="cb24-8"><a href="#cb24-8"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">se =</span> <span class="kw">runif</span>(<span class="kw">n</span>(), <span class="dv">1</span>,<span class="dv">5</span>))</span></code></pre></div>
<p>We can plot the time series using <code>geom_point()</code> and connect the times using <code>geom_line()</code>, coloring by item.</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1"></a><span class="kw">ggplot</span>(timeFrame, <span class="kw">aes</span>(<span class="dt">x =</span> years, <span class="dt">y =</span> price, <span class="dt">color =</span> item)) <span class="op">+</span></span>
<span id="cb25-2"><a href="#cb25-2"></a><span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span></span>
<span id="cb25-3"><a href="#cb25-3"></a><span class="st">  </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">lty =</span> item)) <span class="op">+</span></span>
<span id="cb25-4"><a href="#cb25-4"></a><span class="st">  </span><span class="kw">theme_bw</span>()</span></code></pre></div>
<p><img src="/tutorials/r-core/4-plotting/index_files/figure-html/unnamed-chunk-15-1.png" width="672" /></p>
<p>Now, let’s get some representation of our uncertainty into the plot! Notice that there is an included ‘se’ column for the standard error of each observation. Let’s plot error bars of +/- 1 standard error above and below each point.</p>
<ul>
<li>We can specificy the range of the errorbars with the <code>ymin</code> and <code>ymax</code> arguments</li>
<li>It can also look nice to set width to 0</li>
</ul>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1"></a><span class="kw">ggplot</span>(timeFrame, <span class="kw">aes</span>(<span class="dt">x =</span> years, <span class="dt">y =</span> price, <span class="dt">color =</span> item)) <span class="op">+</span></span>
<span id="cb26-2"><a href="#cb26-2"></a><span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span></span>
<span id="cb26-3"><a href="#cb26-3"></a><span class="st">  </span><span class="kw">geom_line</span>() <span class="op">+</span></span>
<span id="cb26-4"><a href="#cb26-4"></a><span class="st">  </span><span class="kw">geom_errorbar</span>(<span class="kw">aes</span>(<span class="dt">ymin =</span> price <span class="op">-</span><span class="st"> </span>se, <span class="dt">ymax =</span> price <span class="op">+</span><span class="st"> </span>se), <span class="dt">width =</span> <span class="dv">0</span>) <span class="op">+</span></span>
<span id="cb26-5"><a href="#cb26-5"></a><span class="st">  </span><span class="kw">theme_bw</span>() <span class="op">+</span></span>
<span id="cb26-6"><a href="#cb26-6"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&#39;Year&#39;</span>, <span class="dt">y =</span> <span class="st">&#39;Price&#39;</span>, <span class="dt">color =</span> <span class="st">&#39;Item&#39;</span>)</span></code></pre></div>
<p><img src="/tutorials/r-core/4-plotting/index_files/figure-html/unnamed-chunk-16-1.png" width="672" /></p>
<p>Alternatively, we can use shading to express our uncertainty more continuously. This time, let’s shade the error within <strong>2 standard errors</strong> of each measured point.</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1"></a><span class="kw">ggplot</span>(timeFrame, <span class="kw">aes</span>(<span class="dt">x =</span> years, <span class="dt">y =</span> price)) <span class="op">+</span></span>
<span id="cb27-2"><a href="#cb27-2"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(<span class="dt">color =</span> item)) <span class="op">+</span></span>
<span id="cb27-3"><a href="#cb27-3"></a><span class="st">  </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">color =</span> item)) <span class="op">+</span></span>
<span id="cb27-4"><a href="#cb27-4"></a><span class="st">  </span><span class="kw">geom_ribbon</span>(<span class="kw">aes</span>(<span class="dt">ymin =</span> price <span class="op">-</span><span class="st"> </span><span class="dv">2</span><span class="op">*</span>se, <span class="dt">ymax =</span> price <span class="op">+</span><span class="st"> </span><span class="dv">2</span><span class="op">*</span>se, <span class="dt">fill =</span> item), </span>
<span id="cb27-5"><a href="#cb27-5"></a>              <span class="dt">alpha =</span> <span class="fl">.2</span>, <span class="dt">show.legend =</span> F) <span class="op">+</span></span>
<span id="cb27-6"><a href="#cb27-6"></a><span class="st">  </span><span class="kw">theme_bw</span>() <span class="op">+</span></span>
<span id="cb27-7"><a href="#cb27-7"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&#39;Year&#39;</span>, <span class="dt">y =</span> <span class="st">&#39;Price&#39;</span>, <span class="dt">color =</span> <span class="st">&#39;Item&#39;</span>) <span class="op">+</span></span>
<span id="cb27-8"><a href="#cb27-8"></a><span class="st">  </span><span class="kw">scale_color_brewer</span>(<span class="dt">palette =</span> <span class="st">&#39;Dark2&#39;</span>) <span class="op">+</span></span>
<span id="cb27-9"><a href="#cb27-9"></a><span class="st">  </span><span class="kw">scale_fill_brewer</span>(<span class="dt">palette =</span> <span class="st">&#39;Dark2&#39;</span>)</span></code></pre></div>
<p><img src="/tutorials/r-core/4-plotting/index_files/figure-html/unnamed-chunk-17-1.png" width="672" /></p>
<p>Notice we’ve had to reformat a few calls here to adjust the aesthetic mapping…this happens sometimes when we want certain mappings to apply to ONLY certain parts of the plot. When we put the <code>aes()</code> call inside a <code>geom()</code> call, the mapping applies only to that geometrical object.</p>
<p><em>Remember! It’s very important to always display the predictive uncertainty along with the estimates or mean predicted by your model. Otherwise, we don’t have any idea of how confident the model’s predictions are.</em></p>
</div>
</div>
<div id="fitting-lines-to-the-data" class="section level1">
<h1>Fitting Lines to the Data</h1>
<p>Let’s say we think there might be a linear relationship between height and weight.</p>
<p>We can use <code>geom_smooth</code> for this and <code>method = 'lm'</code> specifically for a linear model
Also <code>level = .95</code> can specify the 95% confidence interval about the estimate at each x value.</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1"></a>heightByWeight &lt;-<span class="st"> </span><span class="kw">ggplot</span>(nhanes, <span class="kw">aes</span>(<span class="dt">x =</span> Height, <span class="dt">y =</span> Weight)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb28-2"><a href="#cb28-2"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">size =</span> <span class="fl">.1</span>, <span class="dt">alpha =</span> <span class="fl">.1</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb28-3"><a href="#cb28-3"></a><span class="st">  </span><span class="kw">stat_smooth</span>(<span class="dt">method =</span> <span class="st">&#39;lm&#39;</span>)</span>
<span id="cb28-4"><a href="#cb28-4"></a></span>
<span id="cb28-5"><a href="#cb28-5"></a>heightByWeight</span></code></pre></div>
<pre><code>## `geom_smooth()` using formula &#39;y ~ x&#39;</code></pre>
<p><img src="/tutorials/r-core/4-plotting/index_files/figure-html/unnamed-chunk-18-1.png" width="672" /></p>
<p>Hmm, this actually looks like it’s giving us some pretty bad predictions. We’re not going to get into the stats of this now, but we can also plot using <code>auto</code> which is a mix of models, and might be a bit smarter.</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1"></a>heightByWeight &lt;-<span class="st"> </span><span class="kw">ggplot</span>(nhanes, <span class="kw">aes</span>(<span class="dt">x =</span> Height, <span class="dt">y =</span> Weight)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb30-2"><a href="#cb30-2"></a><span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span><span class="st"> </span></span>
<span id="cb30-3"><a href="#cb30-3"></a><span class="st">  </span><span class="kw">stat_smooth</span>(<span class="dt">method =</span> <span class="st">&#39;auto&#39;</span>, <span class="dt">level =</span> <span class="fl">.99</span>, <span class="dt">alpha =</span> <span class="dv">1</span>, <span class="dt">color =</span> <span class="st">&#39;green&#39;</span>, <span class="dt">fill =</span> <span class="st">&#39;red&#39;</span>)</span>
<span id="cb30-4"><a href="#cb30-4"></a>heightByWeight</span></code></pre></div>
<pre><code>## `geom_smooth()` using method = &#39;gam&#39; and formula &#39;y ~ s(x, bs = &quot;cs&quot;)&#39;</code></pre>
<p><img src="/tutorials/r-core/4-plotting/index_files/figure-html/unnamed-chunk-19-1.png" width="672" /></p>
</div>
<div id="plot-formatting" class="section level1">
<h1>Plot Formatting</h1>
<div id="titles-and-axis-labels" class="section level2">
<h2>Titles and axis labels</h2>
<p>The <code>labs()</code> command can be added to <code>ggplot2</code> with different arguments, lke <code>x</code>, <code>y</code>, or <code>title</code> to make the plots clearer.</p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1"></a>heightByUrban <span class="op">+</span></span>
<span id="cb32-2"><a href="#cb32-2"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&#39;Neighborhood&#39;</span>, <span class="dt">y =</span> <span class="st">&#39;Height in Inches&#39;</span>, <span class="dt">title =</span> <span class="st">&#39;Height by Urban Status&#39;</span>)</span></code></pre></div>
<p><img src="/tutorials/r-core/4-plotting/index_files/figure-html/unnamed-chunk-20-1.png" width="672" /></p>
<p>Note, if we want to change labels for <em>factors</em>, not just axes, it’s easier to do that using <code>tidyverse</code>.</p>
</div>
<div id="facetting" class="section level2">
<h2>Facetting</h2>
<p>It’s useful to have several plots in a panel sometimes, rather than just one.</p>
<p>So for this data set, say we want to plot relationships between height and weight, but by region.</p>
<p>We can do this with <code>facet_wrap('Region')</code>.</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1"></a>facetPlot &lt;-<span class="st"> </span><span class="kw">ggplot</span>(nhanes, <span class="kw">aes</span>(<span class="dt">x =</span> Height, <span class="dt">y =</span> Weight)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb33-2"><a href="#cb33-2"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">alpha =</span> <span class="fl">.2</span>, <span class="dt">size =</span> <span class="fl">.1</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb33-3"><a href="#cb33-3"></a><span class="st">  </span><span class="kw">stat_smooth</span>() <span class="op">+</span><span class="st"> </span></span>
<span id="cb33-4"><a href="#cb33-4"></a><span class="st">  </span><span class="kw">facet_wrap</span>(<span class="st">&#39;Region&#39;</span>)</span>
<span id="cb33-5"><a href="#cb33-5"></a></span>
<span id="cb33-6"><a href="#cb33-6"></a>facetPlot</span></code></pre></div>
<pre><code>## `geom_smooth()` using method = &#39;gam&#39; and formula &#39;y ~ s(x, bs = &quot;cs&quot;)&#39;</code></pre>
<p><img src="/tutorials/r-core/4-plotting/index_files/figure-html/unnamed-chunk-21-1.png" width="672" /></p>
<p>We can even do multiple factors.</p>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1"></a>multiFacet &lt;-<span class="st"> </span><span class="kw">ggplot</span>(nhanes, <span class="kw">aes</span>(<span class="dt">x =</span> Height, <span class="dt">y =</span> Weight)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb35-2"><a href="#cb35-2"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">alpha =</span> <span class="fl">.2</span>, <span class="dt">size =</span> <span class="fl">.5</span>, <span class="kw">aes</span>(<span class="dt">color =</span> Urban)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb35-3"><a href="#cb35-3"></a><span class="st">  </span><span class="kw">stat_smooth</span>() <span class="op">+</span><span class="st"> </span></span>
<span id="cb35-4"><a href="#cb35-4"></a><span class="st">  </span><span class="kw">facet_grid</span>(Region <span class="op">~</span><span class="st"> </span>Urban, <span class="dt">scales =</span> <span class="st">&#39;free_y&#39;</span>)</span>
<span id="cb35-5"><a href="#cb35-5"></a></span>
<span id="cb35-6"><a href="#cb35-6"></a>multiFacet</span></code></pre></div>
<pre><code>## `geom_smooth()` using method = &#39;gam&#39; and formula &#39;y ~ s(x, bs = &quot;cs&quot;)&#39;</code></pre>
<p><img src="/tutorials/r-core/4-plotting/index_files/figure-html/unnamed-chunk-22-1.png" width="672" /></p>
</div>
<div id="color" class="section level2">
<h2>Color</h2>
<p>We can color either continuously or discretely, depending on how a variable is represented in R.</p>
<p>We put <code>color = Height</code> into the <code>aes()</code> function because it’s a grouping factor.</p>
<p><strong>Continous Example:</strong></p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1"></a>weightByRegion &lt;-<span class="st"> </span><span class="kw">ggplot</span>(nhanes, <span class="kw">aes</span>(<span class="dt">x =</span> Region, <span class="dt">y =</span> Weight, <span class="dt">color =</span> Height)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb37-2"><a href="#cb37-2"></a><span class="st">  </span><span class="kw">geom_jitter</span>(<span class="dt">width =</span> <span class="fl">.1</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb37-3"><a href="#cb37-3"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&#39;Region of US&#39;</span>, <span class="dt">y =</span> <span class="st">&#39;Weight (lbs)&#39;</span>, <span class="dt">title =</span> <span class="st">&#39;Weight by Region&#39;</span>)</span>
<span id="cb37-4"><a href="#cb37-4"></a></span>
<span id="cb37-5"><a href="#cb37-5"></a>weightByRegion</span></code></pre></div>
<p><img src="/tutorials/r-core/4-plotting/index_files/figure-html/unnamed-chunk-23-1.png" width="672" /></p>
<p><strong>Discrete Example:</strong></p>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1"></a>discretePlot &lt;-<span class="st"> </span><span class="kw">ggplot</span>(nhanes, <span class="kw">aes</span>(<span class="dt">x =</span> Height, <span class="dt">y =</span> Weight, <span class="dt">color =</span> Region)) <span class="op">+</span></span>
<span id="cb38-2"><a href="#cb38-2"></a><span class="st">  </span><span class="kw">geom_point</span>() </span>
<span id="cb38-3"><a href="#cb38-3"></a></span>
<span id="cb38-4"><a href="#cb38-4"></a>discretePlot</span></code></pre></div>
<p><img src="/tutorials/r-core/4-plotting/index_files/figure-html/unnamed-chunk-24-1.png" width="672" /></p>
<p>It is easy to choose your own custom colors (as well as using R presets), but we’re not going to get into that right at this moment.</p>
</div>
<div id="themes" class="section level2">
<h2>Themes</h2>
<p>We can use themes to make our plots prettier, and also to customize the gridlines.</p>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1"></a>discretePlot <span class="op">+</span><span class="st"> </span></span>
<span id="cb39-2"><a href="#cb39-2"></a><span class="st">  </span><span class="kw">theme_bw</span>()</span></code></pre></div>
<p><img src="/tutorials/r-core/4-plotting/index_files/figure-html/unnamed-chunk-25-1.png" width="672" /></p>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1"></a>discretePlot <span class="op">+</span><span class="st"> </span></span>
<span id="cb40-2"><a href="#cb40-2"></a><span class="st">  </span><span class="kw">theme_minimal</span>()</span></code></pre></div>
<p><img src="/tutorials/r-core/4-plotting/index_files/figure-html/unnamed-chunk-25-2.png" width="672" /></p>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1"></a>discretePlot <span class="op">+</span><span class="st"> </span></span>
<span id="cb41-2"><a href="#cb41-2"></a><span class="st">  </span><span class="kw">theme_void</span>()</span></code></pre></div>
<p><img src="/tutorials/r-core/4-plotting/index_files/figure-html/unnamed-chunk-25-3.png" width="672" /></p>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1"></a>discretePlot <span class="op">+</span><span class="st"> </span></span>
<span id="cb42-2"><a href="#cb42-2"></a><span class="st">  </span><span class="kw">theme_classic</span>()</span></code></pre></div>
<p><img src="/tutorials/r-core/4-plotting/index_files/figure-html/unnamed-chunk-25-4.png" width="672" /></p>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1"></a>facetPlot <span class="op">+</span><span class="st"> </span></span>
<span id="cb43-2"><a href="#cb43-2"></a><span class="st">  </span><span class="kw">theme_bw</span>() <span class="op">+</span><span class="st"> </span></span>
<span id="cb43-3"><a href="#cb43-3"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&#39;Weight by Height and Region&#39;</span>)</span></code></pre></div>
<pre><code>## `geom_smooth()` using method = &#39;gam&#39; and formula &#39;y ~ s(x, bs = &quot;cs&quot;)&#39;</code></pre>
<p><img src="/tutorials/r-core/4-plotting/index_files/figure-html/unnamed-chunk-25-5.png" width="672" /></p>
</div>
</div>
<div id="saving-to-files" class="section level1">
<h1>Saving to Files</h1>
<p><code>ggsave()</code> includes arguments for <code>filename</code>, <code>plot</code>, <code>dpi</code>, <code>width</code>, and <code>height</code> (among other things).</p>
<p>We can use a variety of file formats.</p>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1"></a><span class="kw">ggsave</span>(<span class="st">&#39;newPlotTest.pdf&#39;</span>, <span class="dt">plot =</span> facetPlot, <span class="dt">dpi =</span> <span class="dv">300</span>, <span class="dt">width =</span> <span class="dv">5</span>, <span class="dt">height =</span> <span class="dv">5</span>)</span></code></pre></div>
</div>
<div id="final-points" class="section level1">
<h1>Final Points</h1>
<p>Basic <code>ggplot2</code> will get you a LONG way.</p>
<p>Also, there is much more <code>ggplot2</code> can do for making your plots very pretty, and also plotting lots of complex models.</p>
<p>Unlike Excel and SPSS, which can often be cranky and difficult to bend to your will in customizing plots, <code>ggplot2</code> is really easy to work with to make your graph look the way you want.</p>
<p><strong>Next:</strong> <a href="/tutorials/r-core/5-modeling/">Modeling (Basic modeling in R)</a></p>
</div>
